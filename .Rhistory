summarise_at(vars(gender), funs(counts))
# Q5: province
df_province <- df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(province), funs(counts))
#write.csv(df_province, file = "result/tables/province.csv")
# Q6: ethnicity
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(ethnicity), funs(counts))
# Q7: residence
df_video_intervention %>%
#  group_by(QQ) %>%
summarise_at(vars(residence), funs(counts))
# Q8: education
df_video_intervention %>%
#  group_by(QQ) %>%
summarise_at(vars(education), funs(counts))
# Q9: occupation
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(occupation), funs(counts))
# Q10: income
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(income), funs(counts))
# Q11: Where do you receive your primary information on vaccine?
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(Q11_1, Q11_2, Q11_3, Q11_4, Q11_5, Q11_6, Q11_7), funs(counts))
closeAllConnections()
# Q1: Have you ever been diagnosed with the new coronavirus disease?
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(Q1, Q2_1, Q2_2, Q2_3, Q2_4, Q2_5), funs(counts))
# Q2: Has anyone in your family, neighbors, coworkers, friends or other people you know been diagnosed with the new coronavirus disease? (2-1: family member; 2-2: friend; 2-3 neighbors; 2-4 coworkers; 2-5 others)
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(Q1, Q2_1, Q2_2, Q2_3, Q2_4, Q2_5), funs(counts))
# Q3: Age
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(age), funs(counts))
# Q4: gender
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(gender), funs(counts))
# Q5: province
df_province <- df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(province), funs(counts))
#write.csv(df_province, file = "result/tables/province.csv")
# Q6: ethnicity
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(ethnicity), funs(counts))
# Q7: residence
df_video_intervention %>%
#  group_by(QQ) %>%
summarise_at(vars(residence), funs(counts))
# Q8: education
df_video_intervention %>%
#  group_by(QQ) %>%
summarise_at(vars(education), funs(counts))
# Q9: occupation
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(occupation), funs(counts))
# Q10: income
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(income), funs(counts))
# Q11: Where do you receive your primary information on vaccine?
df_video_intervention %>%
group_by(QQ) %>%
summarise_at(vars(Q11_1, Q11_2, Q11_3, Q11_4, Q11_5, Q11_6, Q11_7), funs(counts))
#
df_video_intervention <- df_video_intervention%>%
tidyr::replace_na(list(TA2_2_T=0, TB2_2_T=0, TC2_2_T=0))
df_video_intervention <- df_video_intervention %>%
mutate (watching_time_1 = TA2_2_T + TB2_2_T+ TC2_2_T)
df_watchingtime <-  df_video_intervention$watching_time_1
s <- tibble(s = 1:12000)
df_watchingtime <- sort(df_watchingtime)
df_watchingtime <- as.data.frame(df_watchingtime)
df_watchingtime <- df_watchingtime %>%
mutate(s)
s <- tibble(s = 1:12000)
df_watchingtime <- sort(df_watchingtime$df_watchingtime)
df_watchingtime <- as.data.frame(df_watchingtime)
df_watchingtime <- df_watchingtime %>%
mutate(s)
#25%50%75% (average time)
df_watchingtime <- df_watchingtime %>%
mutate(
group = case_when(
as.numeric(s) <= 3000 ~ 1,
as.numeric(s) > 3000 & as.numeric(s)<= 6000 ~ 2, as.numeric(s) > 6000 & as.numeric(s)<= 9000 ~ 3,
as.numeric(s) > 9000 ~ 4 )
)
t <- df_watchingtime %>%
group_by(group)%>%
summarise_at(vars(df_watchingtime),list(~mean(.)))
#videoA
df_watchingtime_A <-  df_video_intervention$TA2_2_T
s1 <- tibble(s = 1:3000)
df_watchingtime_A <- sort(df_watchingtime_A$df_watchingtime)
View(df_watchingtime)
df_watchingtime_A <-  df_video_intervention$TA2_2_T
s1 <- tibble(s = 1:3000)
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- sort(df_watchingtime_A$df_watchingtime)
df_watchingtime_A <- df_watchingtime_A %>%
mutate(s)
df_watchingtime_A <-  df_video_intervention$TA2_2_T
df_watchingtime_A <- df_watchingtime_A %>%
mutate(
count = case_when(
as.numeric(df_watchingtime) <= 0 ~ 0,
as.numeric(df_watchingtime) > 0 ~ 1 )
)
df_watchingtime_A <-  df_video_intervention$TA2_2_T
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- df_watchingtime_A %>%
mutate(
count = case_when(
as.numeric(df_watchingtime) <= 0 ~ 0,
as.numeric(df_watchingtime) > 0 ~ 1 )
)
View(df_watchingtime_A)
df_watchingtime_A <-  df_video_intervention$TA2_2_T
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- df_watchingtime_A %>%
mutate(
count = dplyr:case_when(
as.numeric(df_watchingtime) <= 0 ~ 0,
as.numeric(df_watchingtime) > 0 ~ 1 )
)
df_watchingtime_A <-  df_video_intervention$TA2_2_T
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- df_watchingtime_A %>%
mutate(
count = dplyr::case_when(
as.numeric(df_watchingtime) <= 0 ~ 0,
as.numeric(df_watchingtime) > 0 ~ 1 )
)
df_watchingtime_A <-  df_video_intervention$TA2_2_T
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- df_watchingtime_A %>%
dplyr::mutate(
N = dplyr::case_when(
as.numeric(df_watchingtime) <= 0 ~ 0,
as.numeric(df_watchingtime) > 0 ~ 1 )
)
df_watchingtime_A <-  df_video_intervention$TA2_2_T
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- df_watchingtime_A %>%
dplyr::mutate(
N = dplyr::case_when(
as.numeric(df_watchingtime_A) <= 0 ~ 0,
as.numeric(df_watchingtime_A) > 0 ~ 1 )
)
cA <- df_watchingtime_A %>%
summarise_at(vars(N), funs(counts))
View(cA)
View(cA)
r0 <- which(df_watchingtime_A$df_watchingtime_A==0)
df_watchingtime_A[-r0,]
View(df_watchingtime_A)
View(df_watchingtime_A)
r0 <- which(df_watchingtime_A$df_watchingtime_A==0)
df_watchingtime_A[-r0, ]
r0
df_watchingtime_A <-  df_video_intervention$TA2_2_T
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- df_watchingtime_A %>%
dplyr::mutate(
N = dplyr::case_when(
as.numeric(df_watchingtime_A) <= 0 ~ 0,
as.numeric(df_watchingtime_A) > 0 ~ 1 )
)
cA <- df_watchingtime_A %>%
summarise_at(vars(N), funs(counts))
df_watchingtime_A <- sort(df_watchingtime_A$df_watchingtime)
df_watchingtime_A <- df_watchingtime_A %>%
mutate(s)
df_watchingtime_A <- df_watchingtime_A %>%
dplyr::mutate(s)
df_watchingtime_A <- sort(df_watchingtime_A$df_watchingtime)
df_watchingtime_A <-  df_video_intervention$TA2_2_T
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- df_watchingtime_A %>%
dplyr::mutate(
N = dplyr::case_when(
as.numeric(df_watchingtime_A) <= 0 ~ 0,
as.numeric(df_watchingtime_A) > 0 ~ 1 )
)
cA <- df_watchingtime_A %>%
summarise_at(vars(N), funs(counts))
df_watchingtime_A <- sort(df_watchingtime_A$df_watchingtime)
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- df_watchingtime_A %>%
dplyr::mutate(s)
df_watchingtime_A <- df_watchingtime_A %>%
mutate(
group = case_when(
as.numeric(s) <= 8072 ~ 1,
as.numeric(s) > 8072 & as.numeric(s)<= 9054 ~ 2,
as.numeric(s) > 9054 & as.numeric(s)<= 10036 ~ 3,
as.numeric(s) > 10036 & as.numeric(s)<= 11018 ~ 3,
as.numeric(s) > 11018 ~ 4 )
)
tA <- df_watchingtime_A %>%
group_by(group)%>%
summarise_at(vars(df_watchingtime_A),list(~mean(.)))
View(tA)
df_watchingtime_A <-  df_video_intervention$TA2_2_T
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- df_watchingtime_A %>%
dplyr::mutate(
N = dplyr::case_when(
as.numeric(df_watchingtime_A) <= 0 ~ 0,
as.numeric(df_watchingtime_A) > 0 ~ 1 )
)
cA <- df_watchingtime_A %>%
summarise_at(vars(N), funs(counts))
df_watchingtime_A <- sort(df_watchingtime_A$df_watchingtime)
df_watchingtime_A <- as.data.frame(df_watchingtime_A)
df_watchingtime_A <- df_watchingtime_A %>%
dplyr::mutate(s)
df_watchingtime_A <- df_watchingtime_A %>%
mutate(
group = case_when(
as.numeric(s) <= 8072 ~ 1,
as.numeric(s) > 8072 & as.numeric(s)<= 9054 ~ 2,
as.numeric(s) > 9054 & as.numeric(s)<= 10036 ~ 3,
as.numeric(s) > 10036 & as.numeric(s)<= 11018 ~ 4,
as.numeric(s) > 11018 ~ 5 )
)
tA <- df_watchingtime_A %>%
group_by(group)%>%
summarise_at(vars(df_watchingtime_A),list(~mean(.)))
View(tA)
View(df_watchingtime_A)
View(df_video_intervention)
df_watchingtime_B <-  df_video_intervention$TB2_2_T
df_watchingtime_B <- as.data.frame(df_watchingtime_B)
df_watchingtime_B <- df_watchingtime_B %>%
dplyr::mutate(
N = dplyr::case_when(
as.numeric(df_watchingtime_B) <= 0 ~ 0,
as.numeric(df_watchingtime_B) > 0 ~ 1 )
)
cB <- df_watchingtime_B %>%
summarise_at(vars(N), funs(counts))
View(cB)
df_watchingtime_B <- sort(df_watchingtime_B$df_watchingtime_B)
df_watchingtime_B <- as.data.frame(df_watchingtime_B)
df_watchingtime_B <- df_watchingtime_B %>%
dplyr::mutate(s)
df_watchingtime_B <- df_watchingtime_B %>%
mutate(
group = case_when(
as.numeric(s) <= 8451 ~ 1,
as.numeric(s) > 8451 & as.numeric(s)<= 9338 ~ 2,
as.numeric(s) > 9338 & as.numeric(s)<= 10225 ~ 3,
as.numeric(s) > 10225 & as.numeric(s)<= 11112 ~ 4,
as.numeric(s) > 11112 ~ 5 )
)
tB <- df_watchingtime_B %>%
group_by(group)%>%
summarise_at(vars(df_watchingtime_B),list(~mean(.)))
View(tB)
df_watchingtime_C <-  df_video_intervention$TC2_2_T
df_watchingtime_C <- as.data.frame(df_watchingtime_C)
df_watchingtime_C <- df_watchingtime_C %>%
dplyr::mutate(
N = dplyr::case_when(
as.numeric(df_watchingtime_C) <= 0 ~ 0,
as.numeric(df_watchingtime_C) > 0 ~ 1 )
)
cB <- df_watchingtime_C %>%
summarise_at(vars(N), funs(counts))
View(cB)
df_watchingtime_C <- sort(df_watchingtime_C$df_watchingtime_C)
df_watchingtime_C <- as.data.frame(df_watchingtime_C)
df_watchingtime_C <- df_watchingtime_C %>%
dplyr::mutate(s)
df_watchingtime_C <- df_watchingtime_C %>%
mutate(
group = case_when(
as.numeric(s) <= 8485 ~ 1,
as.numeric(s) > 8485 & as.numeric(s)<= 9363 ~ 2,
as.numeric(s) > 9363 & as.numeric(s)<= 10241 ~ 3,
as.numeric(s) > 10241 & as.numeric(s)<= 11119 ~ 4,
as.numeric(s) > 11119 ~ 5 )
)
tC <- df_watchingtime_C %>%
group_by(group)%>%
summarise_at(vars(df_watchingtime_C),list(~mean(.)))
View(tC)
View(t)
df_engagement_yon <- df_video_intervention%>%
subset.data.frame(select = QQ1_4)
c_yon <- df_engagement_yon %>%
summarise_at(vars(QQ1_4), funs(counts))
View(c_yon)
View(c_yon)
df_engagement_yon <- df_video_intervention%>%
subset.data.frame(select = QQ1_4)
c_yon <- df_engagement_yon %>%
summarise_at(vars(QQ1_4), funs(counts))%>%
mutate(p = QQ1_4/12000)
View(c_yon)
df_engagement_true <- df_video_intervention %>%
subset.data.frame(select = TA2_2_T,TB2_2_T,TC2_2_T)%>%
mutate(va = case_when(TA2_2_T<=23700 ~ 0,
TA2_2_T> 23700 & TA2_2_T<= 55300 ~ 1,
TA2_2_T>55300 ~2))%>%
mutate(vb = case_when(TB2_2_T<=25200 ~ 0,
TB2_2_T> 25200 & TB2_2_T<= 58800 ~ 1,
TB2_2_T>58800 ~2))%>%
mutate(vC = case_when(TC2_2_T<=54600 ~ 0,
TC2_2_T> 54600 & TC2_2_T<= 12740 ~ 1,
TC2_2_T>12740 ~2))
#what is their true choice(less than 30% & more than 70%)
df_engagement_true <- df_video_intervention %>%
subset.data.frame(select = c(TA2_2_T,TB2_2_T,TC2_2_T))%>%
mutate(va = case_when(TA2_2_T<=23700 ~ 0,
TA2_2_T> 23700 & TA2_2_T<= 55300 ~ 1,
TA2_2_T>55300 ~2))%>%
mutate(vb = case_when(TB2_2_T<=25200 ~ 0,
TB2_2_T> 25200 & TB2_2_T<= 58800 ~ 1,
TB2_2_T>58800 ~2))%>%
mutate(vC = case_when(TC2_2_T<=54600 ~ 0,
TC2_2_T> 54600 & TC2_2_T<= 12740 ~ 1,
TC2_2_T>12740 ~2))
c_ture <- df_engagement_true %>%
summarise_at(vars(va,vb,vc), funs(counts))
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb,vc)), funs(counts))
df_engagement_true <- df_video_intervention %>%
subset.data.frame(select = c(TA2_2_T,TB2_2_T,TC2_2_T))%>%
mutate(va = case_when(TA2_2_T<=23700 ~ 0,
TA2_2_T> 23700 & TA2_2_T<= 55300 ~ 1,
TA2_2_T>55300 ~2))%>%
mutate(vb = case_when(TB2_2_T<=25200 ~ 0,
TB2_2_T> 25200 & TB2_2_T<= 58800 ~ 1,
TB2_2_T>58800 ~2))%>%
mutate(vc = case_when(TC2_2_T<=54600 ~ 0,
TC2_2_T> 54600 & TC2_2_T<= 12740 ~ 1,
TC2_2_T>12740 ~2))
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb,vc)), funs(counts))
View(df_engagement_true)
#what is their true choice(less than 30% & more than 70%)
df_engagement_true <- df_video_intervention %>%
subset.data.frame(select = c(TA2_2_T,TB2_2_T,TC2_2_T))%>%
mutate(va = case_when(TA2_2_T<=23700 ~ 0,
TA2_2_T> 23700 & TA2_2_T<= 55300 ~ 1,
TA2_2_T>55300 ~2))%>%
mutate(vb = case_when(TB2_2_T<=25200 ~ 0,
TB2_2_T> 25200 & TB2_2_T<= 58800 ~ 1,
TB2_2_T>58800 ~2))%>%
mutate(vc = case_when(TC2_2_T<=54600 ~ 0,
TC2_2_T> 54600 & TC2_2_T<= 12740 ~ 1,
TC2_2_T>12740 ~2))
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb)), funs(counts))
View(c_ture)
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb,vc)), funs(counts))
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb,vc)), funs(counts))%>%
mutate( level = 0,1,2)
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb,vc)), funs(counts))%>%
mutate( level = c(0,1,2))
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb,vc)), funs(counts))%>%
mutate( level = list(0,1,2))
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb,vc)), funs(counts))%>%
mutate( level = 0:2)
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb)), funs(counts))%>%
mutate( level = 0:2)
View(c_ture)
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb)), funs(counts))%>%
mutate( level = 0:2)
c_ture_vc <-  df_engagement_true %>%
summarise_at(vars(c(vc)), funs(counts))%>%
mutate( level = 0,2)
left_join(c_ture,c_ture_vc,by =level )
View(c_ture_vc)
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb)), funs(counts))%>%
mutate( level = 0:2)
c_ture_vc <-  df_engagement_true %>%
summarise_at(vars(c(vc)), funs(counts))%>%
mutate( level = c(0,2))
left_join(c_ture,c_ture_vc,by =level )
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb)), funs(counts))%>%
mutate( level = 0:2)
c_ture_vc <-  df_engagement_true %>%
summarise_at(vars(c(vc)), funs(counts))%>%
mutate( level = c(0,2))
left_join(c_ture,c_ture_vc,by ="level" )
c_ture <- df_engagement_true %>%
summarise_at(vars(c(va,vb)), funs(counts))%>%
mutate( level = 0:2)
c_ture_vc <-  df_engagement_true %>%
summarise_at(vars(c(vc)), funs(counts))%>%
mutate( level = c(0,2))
c_ture <- left_join(c_ture,c_ture_vc,by ="level" )
View(c_ture)
View(df_engagement_true)
df_engagement_ture_n <- df_engagement_true %>%
summarise(
va_vb_n = sum(va == 0 & vb == 2),
va_vc_n = sum(va == 0 & vc == 2),
vb_va_n = sum(vb == 0 & va == 2),
vb_vc_n = sum(vb == 0 & vc == 2),
vc_va_n = sum(vc == 0 & va == 2),
vc_vb_n = sum(vc == 0 & vb == 2)
)
View(df_engagement_ture_n)
install.packages("Rmisc")
library(Rmisc)
View(df_engagement_true)
View(df_watchingtime)
View(df_watchingtime_A)
View(df_watchingtime_B)
View(df_watchingtime_C)
View(df_engagement_yon)
View(df_engagement_true)
View(df_engagement_ture_n)
View(c_ture)
x <- df_watchingtime$df_watchingtime
CI(x,ci = 0.95)
CI(x,ci = 0.99)
CI(x,ci = 0.75)
x <- df_watchingtime$df_watchingtime
CI(x,ci = 0.95)
CI(x,ci = 0.99)
CI(x,ci = 0.75)
x <- df_watchingtime_A$df_watchingtime_A
CI(x,ci = 0.95)
CI(x,ci = 0.99)
CI(x,ci = 0.75)
x <- df_watchingtime_B$df_watchingtime_B
CI(x,ci = 0.95)
CI(x,ci = 0.99)
CI(x,ci = 0.75)
x <- df_watchingtime_B$df_watchingtime_B
CI(x,ci = 0.95)
CI(x,ci = 0.99)
CI(x,ci = 0.75)
x <- df_watchingtime$df_watchingtime
CI(x,ci = 0.95)
CI(x,ci = 0.99)
CI(x,ci = 0.75)
x <- df_watchingtime_A$df_watchingtime_A
CI(x,ci = 0.95)
CI(x,ci = 0.99)
CI(x,ci = 0.75)
x <- df_watchingtime_B$df_watchingtime_B
CI(x,ci = 0.95)
CI(x,ci = 0.99)
CI(x,ci = 0.75)
x <- df_watchingtime_C$df_watchingtime_C
CI(x,ci = 0.95)
CI(x,ci = 0.99)
CI(x,ci = 0.75)
df_video_intervention <- read_sav(here("Data","china_data","20210601 data video intervention.sav"))
# setup
set.seed(123)
library(tidyverse) # pipeline operation
library(haven)
library(ggplot2) #
library(weights) # weighted result
library(srvyr) # deal with survey data
library(fastR2)
library(readxl)
library(lavaan)
library(psych)
library(MBESS)
library(mediation)
library(here) # get current path
library(gtsummary)
library(reshape)
library(Rmisc)
df_video_intervention <- read_sav(here("Data","china_data","20210601 data video intervention.sav"))
## variable coding ------
## SS: consent to participate
## QQ: grouping: 1 - intervention group a; 2 - intervention group b; 3 - intervention group c; 4 - control group
df_video_intervention$group <- as.factor(df_video_intervention$QQ)
## PartVQ: 1 - those who can see the fourth option; 2 - those who cannot
## LA (ordinary vaccine)\LB (COVID-19 vaccine): from 1 - strong disagree to 5 - strongly agree
## LC: 1 - yes; 2 - no
## Basic infomation Q1 - Q11
##
df_video_intervention$age <- as.factor(df_video_intervention$Q3A)
df_video_intervention$gender <- as.factor(df_video_intervention$Q4)
df_video_intervention$province <- as.factor(df_video_intervention$Q5)
df_video_intervention$ethnicity <- as.factor(df_video_intervention$Q6)
df_video_intervention$residence <- as.factor(df_video_intervention$Q7)
df_video_intervention$education <- as.factor(df_video_intervention$Q8)
df_video_intervention$occupation <- as.factor(df_video_intervention$Q9)
df_video_intervention$income <- as.factor(df_video_intervention$Q10)
